---
title: "DNA-nn"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


### Read the dataframe from the files

## Including Plots
## plots above ratio in changes between the false and true values between carb and toby vals

You can also embed plots, for example:
#this segment is used remove NA values from the data 
and provide a summary about the two files being read
```{r pressure, echo=FALSE}
pseudo<-read.csv("responses-pseudo.csv")
summary(pseudo)
good<-complete.cases(pseudo)
pseudo<-pseudo[good,]
counter<-c(pseudo['carb'][])

staph<-read.csv("responses-staph.csv")
good<-complete.cases(staph)
staph<-staph[good,]
summary(staph)

```


```{r}
library(tidyverse)
library(tidyr)
library(dplyr)
library(ggplot2)
good<-complete.cases(pseudo)
pseudo<-pseudo[good,]
summary(pseudo)
```

#The following code segment plots the number of TRUE/FALSE for each value we are considering

```{r}
ggplot(pseudo, aes(factor(carb))) + geom_bar(width = 0.5, fill="light blue", color= "red") + ggtitle("(A) Count of responses to carbenicillin (in pseudomonas)")
ggplot(pseudo, aes(factor(toby))) + geom_bar(width = 0.5, fill="light blue", color= "red") + ggtitle("(B) Count of responses to tobramycin (in pseudomonas)")
ggplot(staph, aes(factor(resp))) + geom_bar(width = 0.5, fill="light pink", color= "black") + ggtitle("(C) Count of responses (in Staphylococcus)")

```

#gives the distance matrix and phylogenetic tree for the given .fasta file.
do recommend reading the source file pages for examples and how to install the packages/dependencies. Does not install
in one try
if it does, let me know because I have Windows

```{r}
library(adegenet)
dna <- fasta2DNAbin(file="concatenated.fasta")
library(ape)
D <- dist.dna(dna, model = "TN93")
length(D)
temp <- as.data.frame(as.matrix(D))
table.paint(temp, cleg=0, clabel.row=.5, clabel.col=.5) #darker shades of gray mean a larger distance # you can also make cool color plots but they're much more complicated because they use the image() function
tre3 <- as.phylo(hclust(D,method="average"))
plot(tre3, cex=.5)
title("UPGMA tree")
```


